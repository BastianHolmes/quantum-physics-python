
Уравнение Шредингера
$$-\frac{\hbar^2}{2m}\psi(x)+U(x)\psi(x)=E\psi(x)$$
Это дифференциальное уравнение второе степени - значит нужны два граничных условия.
$\psi(0)=\psi(L)=0$ - где L - граница.
Прежде всего нужно прийти к безразмерным величинам:
Пусть $x=\xi\cdot l$ , где $\xi$ пробегает от 0 до 1 - т.е. это какая-то часть от длины
$\varepsilon_0=\frac{\hbar^2}{2m\cdot L^2}$ 
Теперь запишем уравнение Шредингера в безразмерном виде:
$$-\varepsilon_0\psi''(\xi)+U(\xi)\psi(\xi)=E\psi(\xi)$$
В чём заключается подход? Говорим, что наша волновая функция это линейная комбинация функций: 
$$\psi=\sum_{k=1}^NC_k\phi_k(\xi)$$
Обычно волновую функцию $\phi$ мы задаём из каких-то соображений, поэтому суть задачи - найти коэффициенты $C_k$ 
Функции должны быть ортогональными, так банально удобно:
$$\braket{\phi_l|\phi_n}=\delta_{l,n}$$
Чтобы решить уравнение - нужно свести его к матричному виду.
$$\int_0^1\psi''(\xi)\phi(\xi)d\xi+\int_0^1V(\xi)\psi(\xi)\phi(\xi)=\frac{E}{\varepsilon_0}\psi(\xi)$$
Теперь сведем это к 
$$\int_0^1\psi''(\xi)\phi(\xi)d\xi=\int_0^1\phi_ld\psi'(\xi)=|^1_0\phi_l\psi'(\xi)-\int_0^1\psi'(\xi)\phi'(\xi)d\xi$$
Тогда переходя к ряду:
$$\sum_{k=1}^NC_k\int_0^1\phi'_k\phi'_ld\xi+\sum_{k=1}^NC_k\int_0^1V_k(\phi_n, \phi_l, d\xi)=\varepsilon\sum_{k=1}^NC_k\int_0^1\phi_k\phi_ld\xi$$
Здесь мы уже наблюдаем матрицы. Первое слагаемое - свертка по k, получаем некую матрицу $T_l,k$
$$[\hat{T}+\hat{V}]\hat{C}=\epsilon\hat{I}\hat{C}$$
Свели уравнение Шредингера к задаче на собственные числа и собственные вектора с матрицей. Если находим все C, то теперь подставляя в сумму $\psi=\sum_{k=1}^NC_k\phi_k(\xi)$ можем найти волновую функцию. 
Сложности:
1) Считать интеграл перекрытия
2) Матрицы 1000 на 1000 тяжело считать, поэтому необходимо выполнять диагонализацию матрицы(или блочную диагонализацию).

Рассмотрим конкретный пример - $\sqrt{2}\sin(\pi k \xi)$  
Тогда искомый ряд: $\psi=\sum_{k=1}^NC_k\sin(\pi k \xi)$
Возьмём параболический потенциал: $V=V_0(\xi-\frac{1}{2})^2$ 
Теперь мы должны посчитать матричные элементы:
$$V_{ck}=V_0\int \sin(\pi k\xi)\sin(\pi l \xi)(\xi-\frac{1}{2})^2d\xi$$
Т.к. базис ортогональный, то при k=l интеграл сводится к интегралу от квадрата синуса, иначе матричный элемент будет равен 0, т.к. функции ортонормированные. 
Теперь рассматривая $V_{lk}$ то при $l\neq k$  
$$V_{lk}=4V_0\frac{1+(-1)^{k+l}}{\pi ^2 (k^-l^2)}kl$$
При $l=k$ 
$$V_{kk}=\frac{V_0}{2}(\frac{1}{6}-\frac{1}{\pi^2k^2})$$
### Метод конечных элементов
Так как в компьютере все дискретно, любой численный метод связан с построением сетки.
$\xi \in \Omega_i$
Рассматриваем некоторые шляпы на сетке (производные второго порядка выходят в ноль, нам не подходят)
$\psi_j(\xi)=\frac{\xi_i-\xi_{j-i}}{L_{j-1}}$
$I_{kk}=\int_0^1\phi^2_n d\xi$ 
Сделаем замену переменной:
$\psi_j(\xi)=\frac{\xi_i-\xi_{j-i}}{L_{j-1}}=\zeta$ Тогда $\xi=\xi_{i-1}+L_{j-1}\zeta$ 
Подставляя её для $\Omega$
$$\psi_i\Omega_j=\frac{\xi_i-\xi}{L_i}=\frac{\xi_i-(\xi_{i-1}+L_{j-1}\zeta)}{L_i}=1-\zeta$$
Тогда:
$$I_{kk}=\int_0^1\phi^2_n d\xi=L_{k-1}\int_0^1\zeta^2d\zeta+L_k\int_0^1\zeta^2d\zeta=\frac{L_{k-1}+L_k}{3}$$
Интегралы перекрытия:
$$I_{k, k+1}=\int_0^1\zeta(1-\zeta)d\zeta=\frac{1}{6}L_k$$
$$I_{k, k-1}=\int_0^1\zeta(1-\zeta)d\zeta=\frac{1}{6}L_{k-1}$$
Если $|k-l|>1$, то интеграл перекрытия нулевой.
Посчитаем кинетическую энергию
$$\hat{T}_{kk}=\int_0^1\phi_k\phi_kd\xi$$
Так получается:
$\phi_i=\frac{\epsilon-\epsilon_{j-1}}{L_{j-1}}$
$\phi_i=\frac{1}{L_{j-1}}$
$$\hat{T}_{kk}=\int_0^1\phi_k\phi_kd\xi=\int_{\Omega_{i-1}}^1\frac{1}{L_{k-1}^2}+\int_{\Omega_i}^1\frac{1}{L_{k}^2}=\frac{1}{L_{k-1}}+\frac{1}{L_{k}}$$
Если рассматривать другой матричный элемент кинетической энергии вида $T_{kk}$: 
$$\hat{T}_{kk-1}=\int_{\Omega_k}^1\frac{1}{L_n}\frac{1}{L_n-1}\xi=-\frac{1}{L_{k-1}}$$
Рассмотрим произвольный потенциал:
$V(\xi)=\sum_1^NV_m\phi_m(\xi)$ 
Получается такой интеграл (в виде матричного элемента)
$$\braket{l|V|k}=\sum_{k=1}^N\sum_{m=1}^NC_kV_m\int_0^1\psi_k\psi_m\psi_ld\xi
$$
Тогда различные матричные элементы можно представить в виде:
$$V_{kk}=V_k\frac{L_{k-1}-L_k}{n}+\frac{V_{n-1}L_{n-1}}{12}+\frac{V_{n+1}L_k}{12}$$
$$V_{kk-1}=\frac{L_{k-1}}{12}(V_{k-1}+V_k)$$
$$V_{kk+1}=\frac{L_{k}}{12}(V_{k}+V_{k+1})$$

### Уравнение Пуассона
$$\frac{d^2}{dx^2}\Phi(x)=-\frac{4\pi}{\varepsilon}\rho(x)$$
Нормируем его:
$$\frac{d^2}{dx^2}V(\xi)=-\frac{4\pi e^2L^2}{\varepsilon}\rho(x)$$
Выделяем лямбду $\lambda=\frac{4\pi e^2L^2}{\varepsilon}$ и подставляя в виде ряда как с УШ получаем уравнение:
$$\int_0^1V''(\xi)\phi_1(\xi)d\xi=-\lambda\int_0^1n(\xi)\phi_1(\xi)d\xi$$
В итоге свелось всё к 
$$\hat{T}\hat{F}=D$$
Где $D=\lambda I N=\lambda\frac{L_{k-1}(n_{k-1}+2n_k)+L_k(2n_k+n_{k+1})}{6}$  
### Система уравнений Пуассона-Шредингера
$$-\frac{\hbar^2}{2m}\psi(x)+(U(x)-e\Phi(x))\psi(x)=E\psi(x)$$$$\frac{d^2}{dx^2}\Phi(x)=-\frac{4\pi}{\varepsilon}n(x)$$
$$n(x)=\sum|\phi(x)|^2$$
Решается итерациями: решаем УШ с нулевым электростатическим потенциалом, находим плотность электронов, из УП находим распределение потенциала, подставляем потенциал в УШ и находим функции с учётом взаимодействия и т.д. Последовательности итераций должна сходиться к решению системы уравнений